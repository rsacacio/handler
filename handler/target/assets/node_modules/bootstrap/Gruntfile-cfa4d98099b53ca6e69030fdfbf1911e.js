module.exports=function(a){a.util.linefeed="\n";RegExp.quote=function(a){return a.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")};var f=require("fs"),g=require("path"),k=require("npm-shrinkwrap"),l=require("./grunt/bs-glyphicons-data-generator.js"),m=require("./grunt/bs-lessdoc-parser.js"),n=require("./grunt/bs-raw-files-generator.js"),p=require("./grunt/bs-commonjs-generator.js"),b=a.file.readJSON("./grunt/configBridge.json",{encoding:"utf8"});Object.keys(b.paths).forEach(function(a){b.paths[a].forEach(function(a,
c,b){b[c]=g.join("./docs/assets",a)})});a.initConfig({pkg:a.file.readJSON("package.json"),banner:'/*!\n * Bootstrap v<%= pkg.version %> (<%= pkg.homepage %>)\n * Copyright 2011-<%= grunt.template.today("yyyy") %> <%= pkg.author %>\n * Licensed under <%= pkg.license.type %> (<%= pkg.license.url %>)\n */\n',jqueryCheck:b.config.jqueryCheck.join("\n"),jqueryVersionCheck:b.config.jqueryVersionCheck.join("\n"),clean:{dist:"dist",docs:"docs/dist"},jshint:{options:{jshintrc:"js/.jshintrc"},grunt:{options:{jshintrc:"grunt/.jshintrc"},
src:["Gruntfile.js","grunt/*.js"]},core:{src:"js/*.js"},test:{options:{jshintrc:"js/tests/unit/.jshintrc"},src:"js/tests/unit/*.js"},assets:{src:["docs/assets/js/src/*.js","docs/assets/js/*.js","!docs/assets/js/*.min.js"]}},jscs:{options:{config:"js/.jscsrc"},grunt:{src:"<%= jshint.grunt.src %>"},core:{src:"<%= jshint.core.src %>"},test:{src:"<%= jshint.test.src %>"},assets:{options:{requireCamelCaseOrUpperCaseIdentifiers:null},src:"<%= jshint.assets.src %>"}},concat:{options:{banner:"<%= banner %>\n<%= jqueryCheck %>\n<%= jqueryVersionCheck %>",
stripBanners:!1},bootstrap:{src:"js/transition.js js/alert.js js/button.js js/carousel.js js/collapse.js js/dropdown.js js/modal.js js/tooltip.js js/popover.js js/scrollspy.js js/tab.js js/affix.js".split(" "),dest:"dist/js/<%= pkg.name %>.js"}},uglify:{options:{preserveComments:"some"},core:{src:"<%= concat.bootstrap.dest %>",dest:"dist/js/<%= pkg.name %>.min.js"},customize:{src:b.paths.customizerJs,dest:"docs/assets/js/customize.min.js"},docsJs:{src:b.paths.docsJs,dest:"docs/assets/js/docs.min.js"}},
qunit:{options:{inject:"js/tests/unit/phantom.js"},files:"js/tests/index.html"},less:{compileCore:{options:{strictMath:!0,sourceMap:!0,outputSourceFiles:!0,sourceMapURL:"<%= pkg.name %>.css.map",sourceMapFilename:"dist/css/<%= pkg.name %>.css.map"},src:"less/bootstrap.less",dest:"dist/css/<%= pkg.name %>.css"},compileTheme:{options:{strictMath:!0,sourceMap:!0,outputSourceFiles:!0,sourceMapURL:"<%= pkg.name %>-theme.css.map",sourceMapFilename:"dist/css/<%= pkg.name %>-theme.css.map"},src:"less/theme.less",
dest:"dist/css/<%= pkg.name %>-theme.css"}},autoprefixer:{options:{browsers:b.config.autoprefixerBrowsers},core:{options:{map:!0},src:"dist/css/<%= pkg.name %>.css"},theme:{options:{map:!0},src:"dist/css/<%= pkg.name %>-theme.css"},docs:{src:["docs/assets/css/anchor.css","docs/assets/css/src/docs.css"]},examples:{expand:!0,cwd:"docs/examples/",src:["**/*.css"],dest:"docs/examples/"}},csslint:{options:{csslintrc:"less/.csslintrc"},dist:["dist/css/bootstrap.css","dist/css/bootstrap-theme.css"],examples:["docs/examples/**/*.css"],
docs:{options:{ids:!1,"overqualified-elements":!1},src:"docs/assets/css/src/docs.css"}},cssmin:{options:{compatibility:"ie8",keepSpecialComments:"*",advanced:!1},minifyCore:{src:"dist/css/<%= pkg.name %>.css",dest:"dist/css/<%= pkg.name %>.min.css"},minifyTheme:{src:"dist/css/<%= pkg.name %>-theme.css",dest:"dist/css/<%= pkg.name %>-theme.min.css"},docs:{src:["docs/assets/css/src/pygments-manni.css","docs/assets/css/src/anchor.css","docs/assets/css/src/docs.css"],dest:"docs/assets/css/docs.min.css"}},
usebanner:{options:{position:"top",banner:"<%= banner %>"},files:{src:"dist/css/*.css"}},csscomb:{options:{config:"less/.csscomb.json"},dist:{expand:!0,cwd:"dist/css/",src:["*.css","!*.min.css"],dest:"dist/css/"},examples:{expand:!0,cwd:"docs/examples/",src:"**/*.css",dest:"docs/examples/"},docs:{src:"docs/assets/css/src/docs.css",dest:"docs/assets/css/src/docs.css"}},copy:{fonts:{expand:!0,src:"fonts/*",dest:"dist/"},docs:{expand:!0,cwd:"dist/",src:["**/*"],dest:"docs/dist/"}},connect:{server:{options:{port:3E3,
base:"."}}},jekyll:{options:{config:"_config.yml"},docs:{},github:{options:{raw:"github: true"}}},jade:{options:{pretty:!0,data:function(){var a=g.join(__dirname,"less/variables.less"),a=f.readFileSync(a,{encoding:"utf8"});return{sections:(new m(a)).parseFile()}}},customizerVars:{src:"docs/_jade/customizer-variables.jade",dest:"docs/_includes/customizer-variables.html"},customizerNav:{src:"docs/_jade/customizer-nav.jade",dest:"docs/_includes/nav/customize.html"}},htmllint:{options:{ignore:['Attribute "autocomplete" not allowed on element "button" at this point.',
'Attribute "autocomplete" not allowed on element "input" at this point.','Element "img" is missing required attribute "src".']},src:"_gh_pages/**/*.html"},watch:{src:{files:"<%= jshint.core.src %>",tasks:["jshint:src","qunit","concat"]},test:{files:"<%= jshint.test.src %>",tasks:["jshint:test","qunit"]},less:{files:"less/**/*.less",tasks:"less"}},sed:{versionNumber:{pattern:function(){var c=a.option("oldver");return c?RegExp.quote(c):c}(),replacement:a.option("newver"),recursive:!0}},"saucelabs-qunit":{all:{options:{build:process.env.TRAVIS_JOB_ID,
throttled:10,maxRetries:3,maxPollRetries:4,urls:["http://127.0.0.1:3000/js/tests/index.html?hidepassed"],browsers:a.file.readYAML("grunt/sauce_browsers.yml")}}},exec:{npmUpdate:{command:"npm update"}},compress:{main:{options:{archive:"bootstrap-<%= pkg.version %>-dist.zip",mode:"zip",level:9,pretty:!0},files:[{expand:!0,cwd:"dist/",src:["**"],dest:"bootstrap-<%= pkg.version %>-dist"}]}}});require("load-grunt-tasks")(a,{scope:"devDependencies"});require("time-grunt")(a);a.registerTask("validate-html",
["jekyll:docs","htmllint"]);var e=function(a){return!process.env.TWBS_TEST||process.env.TWBS_TEST===a},h=function(a){return void 0===a||"0"!==a},d=[];e("core")&&"twbs-savage/bootstrap"!==process.env.TRAVIS_REPO_SLUG&&(d=d.concat(["dist-css","dist-js","csslint:dist","test-js","docs"]));e("validate-html")&&h(process.env.TWBS_DO_VALIDATOR)&&d.push("validate-html");"undefined"!==typeof process.env.SAUCE_ACCESS_KEY&&e("sauce-js-unit")&&h(process.env.TWBS_DO_SAUCE)&&(d.push("connect"),d.push("saucelabs-qunit"));
a.registerTask("test",d);a.registerTask("test-js","jshint:core jshint:test jshint:grunt jscs:core jscs:test jscs:grunt qunit".split(" "));a.registerTask("dist-js",["concat","uglify:core","commonjs"]);a.registerTask("less-compile",["less:compileCore","less:compileTheme"]);a.registerTask("dist-css","less-compile autoprefixer:core autoprefixer:theme usebanner csscomb:dist cssmin:minifyCore cssmin:minifyTheme".split(" "));a.registerTask("dist",["clean:dist","dist-css","copy:fonts","dist-js"]);a.registerTask("default",
["clean:dist","copy:fonts","test"]);a.registerTask("change-version-number","sed");a.registerTask("build-glyphicons-data",function(){l.call(this,a)});a.registerTask("build-customizer",["build-customizer-html","build-raw-files"]);a.registerTask("build-customizer-html","jade");a.registerTask("build-raw-files","Add scripts/less files to customizer.",function(){var c=a.template.process("<%= banner %>");n(a,c)});a.registerTask("commonjs","Generate CommonJS entrypoint module in dist dir.",function(){var c=
a.config.get("concat.bootstrap.src");p(a,c,"dist/js/npm.js")});a.registerTask("docs-css",["autoprefixer:docs","autoprefixer:examples","csscomb:docs","csscomb:examples","cssmin:docs"]);a.registerTask("lint-docs-css",["csslint:docs","csslint:examples"]);a.registerTask("docs-js",["uglify:docsJs","uglify:customize"]);a.registerTask("lint-docs-js",["jshint:assets","jscs:assets"]);a.registerTask("docs","docs-css lint-docs-css docs-js lint-docs-js clean:docs copy:docs build-glyphicons-data build-customizer".split(" "));
a.registerTask("prep-release",["jekyll:github","compress"]);a.registerTask("update-shrinkwrap",["exec:npmUpdate","_update-shrinkwrap"]);a.registerTask("_update-shrinkwrap",function(){var c=this.async();k({dev:!0,dirname:__dirname},function(b){b&&a.fail.warn(b);f.renameSync("npm-shrinkwrap.json","test-infra/npm-shrinkwrap.json");a.log.writeln("File "+"test-infra/npm-shrinkwrap.json".cyan+" updated.");c()})})};